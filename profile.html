  <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Profile - Speak Louder, Love Harder</title>
  <link rel="stylesheet" href="styles.css" />
</head>

<body>
  <div class="logo" tabindex="0">Speak Louder, Love Harder</div>
  <nav role="navigation" aria-label="Main navigation">
    <a href="index.html" class="btn-nav">Home</a>
    <a href="mental-health.html" class="btn-nav">Mental Health</a>
    <a href="addiction.html" class="btn-nav">Addiction</a>
    <a href="cystic-fibrosis.html" class="btn-nav">Cystic Fibrosis</a>
    <a href="cirrhosis.html" class="btn-nav">Cirrhosis</a>
    <a href="foster-children.html" class="btn-nav">Foster Children</a>
    <a href="pitbull-love.html" class="btn-nav">Pitbull Love</a>
    <a href="mental-abuse.html" class="btn-nav">Mental Abuse</a>
    <a href="physical-abuse.html" class="btn-nav">Physical Abuse</a>
    <a href="sexual-abuse.html" class="btn-nav">Sexual Abuse</a>
    <a href="affirmations.html" class="btn-nav">Affirmations</a>
    <a href="worksheets.html" class="btn-nav">Worksheets</a>
    <a href="quotes.html" class="btn-nav">Quotes</a>
    <a href="profile.html" class="btn-nav">Profile</a>
    <a href="settings.html" class="btn-nav">Settings</a>
    <a href="logout.html" class="btn-nav">Logout</a>
  </nav>
</header>
      
    <main>
    <section class="profile-section">
      <h2>Update Your Profile Picture</h2>
      <div class="profile-pic-wrapper">
        <img id="profile-pic" src="default-avatar.png" alt="Profile Picture" />
        <input type="file" id="file-input" accept="image/*" />
        <button id="upload-btn">Upload Picture</button>
      </div>
    </section>

    <h1 id="username" class="profile-username" tabindex="0">Loading...</h1>
    <p id="bio" class="profile-bio" tabindex="0">Loading your bio...</p>

    <section class="profile-stats" aria-label="User statistics">
      <div>
        <strong tabindex="0">124</strong><span>Posts</span>
      </div>
      <div>
        <strong tabindex="0">3.5K</strong><span>Followers</span>
      </div>
      <div>
        <strong tabindex="0">250</strong><span>Following</span>
      </div>
    </section>

    <a href="settings.html" class="btn-edit-profile" role="button" tabindex="0">Edit Profile</a>

    <section class="profile-posts" aria-label="User posts">
      <!-- You can later fetch real posts from Supabase -->
      <article class="profile-post" tabindex="0">
        <h3>Mindfulness and Me</h3>
        <p>Just finished a great meditation session.</p>
      </article>
    </section>
  </main>

  <footer role="contentinfo">
    <p>&copy; 2025 Speak Louder, Love Harder |
      <a href="https://linktr.ee/rissa.star" target="_blank" rel="noopener noreferrer">More Links</a>
    </p>
  </footer>

 <script type="module">
    import { createClient } from "https://esm.sh/@supabase/supabase-js";

    const supabase = createClient(
      "https://ytgrzhtntwzefwjmhgjj.supabase.co",
      "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inl0Z3J6aHRudHd6ZWZ3am1oZ2pqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MDcyNDI2ODIsImV4cCI6MjAyMjgyODY4Mn0.ZMN1LJrYO7O-9kn5nE7XMaKV3y7JKX5deJv8z6Itel8"
    );

    const usernameEl = document.getElementById("username");
    const bioEl = document.getElementById("bio");
    const avatarEl = document.getElementById("profile-pic");

    async function loadProfile() {
      const { data: { user }, error: userError } = await supabase.auth.getUser();
      if (!user || userError) {
        console.error("Auth error:", userError);
        alert("You must be logged in.");
        return;
      }

      const { data: profile, error } = await supabase
        .from("profiles")
        .select("username, bio, avatar_url")
        .eq("id", user.id)
        .single();

      if (error) {
        console.error("Profile load error:", error.message);
        return;
      }

      usernameEl.textContent = profile.username || "No username";
      bioEl.textContent = profile.bio || "No bio available";
      if (profile.avatar_url) {
        avatarEl.src = profile.avatar_url;
      }
    }

    async function loadPosts() {
      const { data: { user } } = await supabase.auth.getUser();
      if (!user) return;

      const { data, error } = await supabase
        .from("posts")
        .select("title, content, created_at")
        .eq("user_id", user.id)
        .order("created_at", { ascending: false });

      const postsSection = document.querySelector(".profile-posts");
      postsSection.innerHTML = "";

      if (data && data.length > 0) {
        data.forEach((post) => {
          const article = document.createElement("article");
          article.className = "profile-post";
          article.tabIndex = 0;
          article.innerHTML = `
            <h3>${post.title}</h3>
            <p>${post.content}</p>
          `;
          postsSection.appendChild(article);
        });
      } else {
        postsSection.innerHTML = "<p>No posts yet.</p>";
      }
    }

    // Initialize
    loadProfile();
    loadPosts();
  </script>
</body>
</html>