<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>My Profile â€“ Speak Louder, Love Harder ðŸŒŸ</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body class="theme-purple light-mode">
  <div class="profile-container">
    <h2>Welcome, <span id="username">Loading...</span> ðŸ’–</h2>
    <img id="profilePic" src="" alt="Profile Picture" class="avatar"/>
    <p>Your Mood: <span id="mood">ðŸŒˆ</span></p>
    <p>Your Theme: <span id="userTheme">ðŸŽ¨</span></p>
    <button id="logoutBtn">Logout</button>
  </div>

  <script type="module">
    import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";
    import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";
    import { app } from "./firebase.js";

    const auth = getAuth();
    const db = getFirestore();

    const username = document.getElementById("username");
    const mood = document.getElementById("mood");
    const theme = document.getElementById("userTheme");
    const profilePic = document.getElementById("profilePic");

    onAuthStateChanged(auth, async (user) => {
      if (!user) return window.location.href = "login.html";
      const docSnap = await getDoc(doc(db, "users", user.uid));
      if (docSnap.exists()) {
        const data = docSnap.data();
        username.textContent = data.displayName || user.email;
        mood.textContent = data.mood;
        theme.textContent = data.theme;
        profilePic.src = data.profilePicture || "https://placekitten.com/100/100";
      }
    });

    document.getElementById("logoutBtn").onclick = async () => {
      await signOut(auth);
      window.location.href = "login.html";
    };
  </script>
  
  <!-- Firebase App + Auth + Firestore -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
  import {
    getAuth,
    onAuthStateChanged,
    GoogleAuthProvider,
    signInWithPopup,
    createUserWithEmailAndPassword,
    signInWithEmailAndPassword,
    signOut
  } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";
  import {
    getFirestore,
    doc,
    setDoc,
    getDoc
  } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyCzmBdZJrtHEoxcAHte2B8iMrea-ctSxy8",
    authDomain: "speak-louder-581d7.firebaseapp.com",
    projectId: "speak-louder-581d7",
    storageBucket: "speak-louder-581d7.appspot.com",
    messagingSenderId: "674769404942",
    appId: "1:674769404942:web:1cbda7d50ff15208dce85f",
    measurementId: "G-54XJLK1CGJ"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth();
  const db = getFirestore();
</script>
</body>
</html>