<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Dashboard – Speak Louder, Love Harder</title>
  <link rel="stylesheet" href="styles.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <header class="animated-header glow">Speak Louder, Love Harder - Dashboard</header>

  <nav>
    <ul class="nav-links">
      <li><a href="index.html">Home</a></li>
      <li><a href="guestbook.html">Guestbook</a></li>
      <li><a href="resources.html">Resources</a></li>
      <li><a href="settings.html">Settings</a></li>
      <li><a href="#" id="logoutBtn">Logout</a></li>
    </ul>
  </nav>

  <main style="max-width: 900px; margin: 2rem auto; padding: 0 1rem;">
    <section id="welcomeSection">
      <h2 id="welcomeMessage">Welcome back!</h2>
    </section>

    <section id="profileSection" style="margin-top: 2rem;">
      <h3>Your Profile</h3>
      <form id="profileForm" style="display: flex; flex-direction: column; max-width: 400px;">
        <label for="profileName">Name:</label>
        <input type="text" id="profileName" name="profileName" placeholder="Your name" required />

        <label for="profileBio">Bio:</label>
        <textarea id="profileBio" name="profileBio" placeholder="A short bio about you..." rows="3"></textarea>

        <button type="submit" class="button" style="margin-top: 1rem; width: fit-content;">Save Profile</button>
      </form>
      <p id="profileSaveMessage" style="color: var(--secondary); margin-top: 0.5rem;"></p>
    </section>

    <section id="affirmationsSection" style="margin-top: 3rem; text-align: center;">
      <h3>Daily Affirmation</h3>
      <blockquote id="dailyAffirmation" style="font-size: 1.3rem; font-style: italic; margin-bottom: 1rem;">Loading...</blockquote>
      <button id="newAffirmationBtn" class="button">New Affirmation</button>
    </section>

    <section id="moodTrackerSection" style="margin-top: 3rem;">
      <h3>Mood Tracker</h3>
      <canvas id="moodChart" style="max-width: 600px; margin: 1rem auto; display: block;"></canvas>
    </section>

    <section id="resourcesSection" style="margin-top: 3rem;">
      <h3>Bookmarked Resources</h3>
      <ul id="bookmarkedResources" style="list-style: none; padding-left: 0;">
        <!-- dynamically inserted -->
      </ul>
    </section>

    <section id="guestbookPosts" style="margin-top: 3rem;">
      <h3>Recent Guestbook Posts</h3>
      <ul id="guestbookList" style="list-style: none; padding-left: 0;">
        <!-- Placeholder static posts -->
        <li>💬 “Keep going, you're doing amazing!” — User123</li>
        <li>💬 “This community is my safe space.” — SoulSeeker</li>
        <li>💬 “Remember, you are loved.” — HeartStrong</li>
      </ul>
    </section>
  </main>

  <script>
    // Affirmations list
    const affirmations = [
      "You are worthy of love and happiness.",
      "You have the strength to overcome.",
      "Your voice matters.",
      "You radiate positivity and light.",
      "You are doing your best, and that's enough."
    ];

    // Bookmarked resources example (could come from localStorage or server)
    const exampleResources = [
      { title: "Mental Health Tips", url: "https://www.mentalhealth.gov/tips" },
      { title: "Daily Affirmations Guide", url: "https://www.affirmations.com" },
      { title: "Support Groups Directory", url: "https://www.supportgroups.com" }
    ];

    // Mood tracker dummy data: last 7 days moods from 1-5 scale
    const moodData = [3, 4, 2, 5, 4, 3, 4];
    const moodLabels = ["Mon", "Tue", "Wed", "Thu", "Fri", "Sat", "Sun"];

    // Load user profile from localStorage
    function loadUserProfile() {
      const name = localStorage.getItem("profileName") || "";
      const bio = localStorage.getItem("profileBio") || "";
      document.getElementById("profileName").value = name;
      document.getElementById("profileBio").value = bio;
      const user = localStorage.getItem("currentUser");
      document.getElementById("welcomeMessage").textContent = user ? `Hi, ${user}! 💖` : "Welcome back!";
    }

    // Save user profile to localStorage
    document.getElementById("profileForm").addEventListener("submit", e => {
      e.preventDefault();
      const name = document.getElementById("profileName").value.trim();
      const bio = document.getElementById("profileBio").value.trim();
      localStorage.setItem("profileName", name);
      localStorage.setItem("profileBio", bio);
      document.getElementById("profileSaveMessage").textContent = "Profile saved successfully!";
      setTimeout(() => {
        document.getElementById("profileSaveMessage").textContent = "";
      }, 3000);
    });

    // Rotate affirmation
    function showRandomAffirmation() {
      const i = Math.floor(Math.random() * affirmations.length);
      document.getElementById("dailyAffirmation").textContent = affirmations[i];
    }

    document.getElementById("newAffirmationBtn").addEventListener("click", showRandomAffirmation);

    // Load bookmarked resources list
    function loadBookmarkedResources() {
      const ul = document.getElementById("bookmarkedResources");
      ul.innerHTML = "";
      exampleResources.forEach(r => {
        const li = document.createElement("li");
        li.innerHTML = `<a href="${r.url}" target="_blank" rel="noopener noreferrer">${r.title}</a>`;
        ul.appendChild(li);
      });
    }

    // Mood Chart setup
    function setupMoodChart() {
      const ctx = document.getElementById("moodChart").getContext("2d");
      new Chart(ctx, {
        type: "line",
        data: {
          labels: moodLabels,
          datasets: [{
            label: "Mood (1-5)",
            data: moodData,
            backgroundColor: "rgba(236, 72, 153, 0.4)",
            borderColor: "#ec4899",
            borderWidth: 3,
            tension: 0.4,
            fill: true,
            pointRadius: 5,
            pointBackgroundColor: "#a855f7"
          }]
        },
        options: {
          scales: {
            y: {
              min: 1,
              max: 5,
              ticks: {
                stepSize: 1
              }
            }
          },
          plugins: {
            legend: {
              labels: {
                color: window.getComputedStyle(document.body).color
              }
            }
          },
          responsive: true,
          maintainAspectRatio: false
        }
      });
    }

    // Logout button clears localStorage user and redirects to login page
    document.getElementById("logoutBtn").addEventListener("click", () => {
      localStorage.removeItem("currentUser");
      window.location.href = "login.html";
    });

    // Theme toggle (dark/light)
    function setupThemeToggle() {
      const toggle = document.createElement("div");
      toggle.className = "theme-toggle";
      toggle.textContent = "🌗";
      document.body.appendChild(toggle);

      // Initialize theme from storage
      const darkMode = localStorage.getItem("darkMode") === "true";
      document.body.classList.toggle("dark-mode", darkMode);

      toggle.addEventListener("click", () => {
        const isDark = document.body.classList.toggle("dark-mode");
        localStorage.setItem("darkMode", isDark);
      });
    }

    // Initialize page
    document.addEventListener("DOMContentLoaded", () => {
      loadUserProfile();
      showRandomAffirmation();
      loadBookmarkedResources();
      setupMoodChart();
      setupThemeToggle();
    });
  </script>
</body>
</html>