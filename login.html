<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Login ‚Äì Speak Louder, Love Harder üåü</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body class="theme-purple light-mode">
  <div class="login-container">
    <h2>üîê Login or Register</h2>
    <input type="email" id="email" placeholder="Email" />
    <input type="password" id="password" placeholder="Password" />
    <button id="loginBtn">Login</button>
    <button id="registerBtn">Register</button>
    <hr>
    <button id="googleLogin">Sign in with Google</button>
    <p id="loginStatus"></p>
  </div>

  <script type="module">
  <!-- Firebase App + Auth + Firestore -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
  import {
    getAuth,
    onAuthStateChanged,
    GoogleAuthProvider,
    signInWithPopup,
    createUserWithEmailAndPassword,
    signInWithEmailAndPassword,
    signOut
  } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";
  import {
    getFirestore,
    doc,
    setDoc,
    getDoc
  } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyCzmBdZJrtHEoxcAHte2B8iMrea-ctSxy8",
    authDomain: "speak-louder-581d7.firebaseapp.com",
    projectId: "speak-louder-581d7",
    storageBucket: "speak-louder-581d7.appspot.com",
    messagingSenderId: "674769404942",
    appId: "1:674769404942:web:1cbda7d50ff15208dce85f",
    measurementId: "G-54XJLK1CGJ"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth();
  const db = getFirestore();
</script>
    import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, signInWithPopup, GoogleAuthProvider } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";
    import { getFirestore, doc, setDoc } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";
    import { app } from "./firebase.js";

    const auth = getAuth();
    const db = getFirestore();

    const loginBtn = document.getElementById("loginBtn");
    const registerBtn = document.getElementById("registerBtn");
    const googleBtn = document.getElementById("googleLogin");

    loginBtn.onclick = async () => {
      const email = document.getElementById("email").value;
      const pass = document.getElementById("password").value;
      try {
        await signInWithEmailAndPassword(auth, email, pass);
        window.location.href = "profile.html";
      } catch (err) {
        document.getElementById("loginStatus").textContent = err.message;
      }
    };

    registerBtn.onclick = async () => {
      const email = document.getElementById("email").value;
      const pass = document.getElementById("password").value;
      try {
        const userCredential = await createUserWithEmailAndPassword(auth, email, pass);
        await setDoc(doc(db, "users", userCredential.user.uid), {
          email,
          theme: "purple",
          mood: "üåà",
          displayName: email.split("@")[0],
        });
        window.location.href = "profile.html";
      } catch (err) {
        document.getElementById("loginStatus").textContent = err.message;
      }
    };

    googleBtn.onclick = async () => {
      const provider = new GoogleAuthProvider();
      try {
        const result = await signInWithPopup(auth, provider);
        const user = result.user;
        await setDoc(doc(db, "users", user.uid), {
          email: user.email,
          displayName: user.displayName,
          profilePicture: user.photoURL,
          theme: "purple",
          mood: "üåà"
        }, { merge: true });
        window.location.href = "profile.html";
      } catch (err) {
        document.getElementById("loginStatus").textContent = err.message;
      }
    };
  </script>
</body>
</html>